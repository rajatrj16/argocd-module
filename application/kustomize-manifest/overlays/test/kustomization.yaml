apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
  - ../../base

commonLabels:
  purpose: Argocd-demo
  env : test

#nameSuffix: -test

replicas:
  - name: web-frontend
    count: 2
  - name: customers-v2
    count: 3

patches:
  - target:
      kind: Deployment
      name: web-frontend
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/env/0/value
        value: 'http://customers.test-app.svc.cluster.local'

  - target:
      kind: Deployment
      name: web-frontend
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/image
        value: 'rajatrj16/frontend-image:e175e0b6ddeb49f46836b847b26564c8e6b0c1d2'
        
  - target:
      kind: Deployment
      name: customers-v2
    patch: |-
      - op: replace
        path: /spec/template/spec/containers/0/image
        value: 'rajatrj16/backend-image:e175e0b6ddeb49f46836b847b26564c8e6b0c1d2'
